using Microsoft.Graph;

private async Task EnsureFolderExistsAsync(string driveId, string folderName)
{
    try
    {
        // Se conseguir buscar a pasta, ela existe ✅
        await _graphClient
            .Drives[driveId]
            .Root
            .ItemWithPath(folderName)
            .GetAsync();
    }
    catch (Microsoft.Graph.Models.ODataErrors.ODataError)
    {
        // Se não existe, cria ✅
        var folderToCreate = new DriveItem
        {
            Name = folderName,
            Folder = new Folder()
        };

        await _graphClient
            .Drives[driveId]
            .Items["root"]
            .Children
            .PostAsync(folderToCreate);
    }
}
