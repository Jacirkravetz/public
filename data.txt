using System;
using System.Threading.Tasks;
using MailKit.Net.Smtp;
using MimeKit;

class Program
{
    static async Task Main(string[] args)
    {
        string smtpServer = "smtp.gmail.com"; // SMTP do provedor (exemplo: Gmail)
        int smtpPort = 465; // Porta 465 para SSL
        string senderEmail = "seuemail@gmail.com"; // Seu e-mail
        string senderPassword = "suasenha"; // Senha ou App Password
        string recipientEmail = "destinatario@gmail.com"; // E-mail do destinatário
        string subject = "Teste de E-mail via .NET 8";
        string body = "Este é um e-mail enviado via .NET 8 usando MailKit com SSL.";

        await SendEmailAsync(smtpServer, smtpPort, senderEmail, senderPassword, recipientEmail, subject, body);
    }

    static async Task SendEmailAsync(string smtpServer, int smtpPort, string senderEmail, string senderPassword, string recipientEmail, string subject, string body)
    {
        try
        {
            var message = new MimeMessage();
            message.From.Add(new MailboxAddress("Remetente", senderEmail));
            message.To.Add(new MailboxAddress("Destinatário", recipientEmail));
            message.Subject = subject;

            message.Body = new TextPart("plain") { Text = body };

            using var client = new SmtpClient();
            await client.ConnectAsync(smtpServer, smtpPort, true); // Habilita SSL
            await client.AuthenticateAsync(senderEmail, senderPassword);
            await client.SendAsync(message);
            await client.DisconnectAsync(true);

            Console.WriteLine("✅ E-mail enviado com sucesso!");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"❌ Erro ao enviar e-mail: {ex.Message}");
        }
    }
}
