public static bool IsWithinCutoff(CutOffWindow[] windows, bool isHoliday)
{
    var now = DateTime.Now;
    var currentDay = now.DayOfWeek;
    var currentTime = now.TimeOfDay;

    foreach (var window in windows)
    {
        if (window.DayOfWeek != currentDay)
            continue;

        if (window.ExcludeHolidays && isHoliday)
            continue;

        if (currentTime >= window.StartTime && currentTime <= window.EndTime)
            return true;
    }

    return false;
}
