DECLARE 
    v_start_time TIMESTAMP;
    v_end_time TIMESTAMP;
    v_elapsed_time INTERVAL DAY TO SECOND;
BEGIN
    -- Captura o horário inicial
    v_start_time := SYSTIMESTAMP;
    
    -- Criando a tabela temporária
    EXECUTE IMMEDIATE 'CREATE GLOBAL TEMPORARY TABLE TMP_CLIENTES_SINACOR (
        CNPJ VARCHAR2(20),
        CONTA VARCHAR2(20),
        STATUS VARCHAR2(10)
    ) ON COMMIT PRESERVE ROWS';
    
    -- Inserindo os dados na tabela temporária
    INSERT INTO TMP_CLIENTES_SINACOR (CNPJ, CONTA, STATUS)
    SELECT CNPJ, CONTA, STATUS FROM VW_CLIENTES_SINACOR;

    -- Commit para confirmar a transação
    COMMIT;

    -- Captura o horário final
    v_end_time := SYSTIMESTAMP;
    
    -- Calcula o tempo decorrido
    v_elapsed_time := v_end_time - v_start_time;
    
    -- Exibe o tempo total
    DBMS_OUTPUT.PUT_LINE('Tempo total: ' || v_elapsed_time);
END;
/
