using System.Collections.Generic;
using System.Data.SqlClient;
using System.Linq;

public void MergeSqlParameters(List<SqlParameter> parameters, Dictionary<string, string> overrides)
{
    if (overrides == null || overrides.Count == 0)
        return;

    foreach (var kvp in overrides)
    {
        var key = kvp.Key.TrimStart('@');
        var value = kvp.Value;

        // Procura um parÃ¢metro existente com o mesmo nome (ignorando o @)
        var existingParam = parameters.FirstOrDefault(p => p.ParameterName.TrimStart('@').Equals(key, System.StringComparison.OrdinalIgnoreCase));

        if (existingParam != null)
        {
            existingParam.Value = value;
        }
        else
        {
            parameters.Add(new SqlParameter("@" + key, value));
        }
    }
}
