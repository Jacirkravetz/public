using System;
using System.Collections.Generic;
using Confluent.Kafka.Admin;

class Program
{
    static void Main()
    {
        string bootstrapServers = "localhost:9092";

        ListConsumerGroups(bootstrapServers);
    }

    static void ListConsumerGroups(string bootstrapServers)
    {
        using (var adminClient = new AdminClientBuilder(new AdminClientConfig { BootstrapServers = bootstrapServers }).Build())
        {
            try
            {
                var groups = adminClient.ListConsumerGroupsAsync().Result;

                Console.WriteLine("Consumer Groups:");
                foreach (var group in groups.Valid)
                {
                    Console.WriteLine($"- {group.GroupId}");
                }
            }
            catch (Exception ex)
            {
                Console.WriteLine($"Erro ao listar consumer groups: {ex.Message}");
            }
        }
    }
}
