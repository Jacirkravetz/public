public static bool IsWithinCutoff(CutOffWindow window, bool isHoliday)
{
    var now = DateTime.Now;
    if ((DayOfWeek)now.DayOfWeek != window.DayOfWeek)
        return false;

    if (window.ExcludeHolidays && isHoliday)
        return false;

    var time = now.TimeOfDay;
    return time >= window.StartTime && time <= window.EndTime;
}
