[Test]
public async Task ExtractSectionsAsync_ShouldThrowSecurityException_WhenXmlIsNullOrEmpty()
{
    // Arrange
    string xml = "";
    var includedSections = new List<string> { "*" };

    // Act
    var ex = await NUnit.Framework.Assert.ThrowsAsync<SecurityException>(async () =>
    {
        await XmlRecursiveExtractor.ExtractSectionsAsync(xml, "Pedido", includedSections);
    });

    // Assert
    Assert.That(ex.Message, Is.EqualTo("XML input cannot be null or empty."));
}



Assert.That(async () => await XmlRecursiveExtractor.ExtractSectionsAsync(xml, "Pedido", includedSections),
            Throws.TypeOf<SecurityException>().With.Message.EqualTo("XML input cannot be null or empty."));
