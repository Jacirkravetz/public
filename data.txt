using System.Collections.Generic;
using System.Data.SqlClient;
using System.Text.RegularExpressions;

private string ReplaceTemplate(string template, IEnumerable<SqlParameter> parameters)
{
    if (string.IsNullOrWhiteSpace(template))
        return template;

    // Cria um dicionário com os parâmetros para busca rápida
    var parameterDict = new Dictionary<string, string>(StringComparer.OrdinalIgnoreCase);
    foreach (var param in parameters)
    {
        if (param.Value != null)
            parameterDict[param.ParameterName.TrimStart('@')] = param.Value.ToString();
    }

    return Regex.Replace(template, @"\{(.*?)\}", match =>
    {
        var key = match.Groups[1].Value;
        return parameterDict.TryGetValue(key, out var value) ? value : string.Empty;
    });
}
